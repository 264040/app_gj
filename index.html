<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>国际音标学习</title>
    <link rel="stylesheet" href="./css/styles.css">
    <link href="./favicon.ico">
</head>

<body>
    <header>
        <!-- <div class="logo">国际音标学习</div> -->
        <div class="logoimg"> <img data-v-689f6ef2=""
                src="https://www.xdf.cn/zhuanti/bd-phonetic-alphabet-card/resource/img/top-bg-c763567.png"
                class="top_img">
        </div>
    </header>

    <div class="theme-switch" onclick="toggleDarkMode()">🌙</div>

    <section class="content">
        <p>点击音标发音</p>

        <!-- 动态生成选项卡 -->
        <div class="tabs" id="tabs">
            <!-- 选项卡会动态生成 -->
        </div>

        <!-- 音标展示容器 -->
        <div id="ipa-container" class="ipa-container">
            <!-- 音标按钮会动态渲染到这里 -->
        </div>
    </section>

    <div id="diagram-container" class="diagram-container">
        <p>点击音标查看图解</p>
    </div>
    <div class="coming-soon">
        敬请期待...
    </div>

    <script src="./js/toggleDarkMode.js"></script>
    <script>

        async function getJsonData() {
            try {
                const response = await fetch("https://appgj.netlify.app/js/jsons.json");
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const data = await response.json();
                console.log(data, 1111); // 输出 JSON 数据

                // 动态生成选项卡
                function generateTabs(e) {
                    const tabsContainer = document.getElementById('tabs');
                    // 遍历 ipaData 创建选项卡
                    Object.keys(data).forEach(key => {
                        const tabBtn = document.createElement('div');
                        tabBtn.classList.add('tab-btn');
                        tabBtn.textContent = data[key].name;
                        tabBtn.id = key + '-tab';
                        tabBtn.onclick = () => showTab(key);
                        tabsContainer.appendChild(tabBtn);
                    });

                    // 默认显示第一个选项卡
                    const firstTab = Object.keys(data)[0];
                    showTab(firstTab);
                }

                // 渲染音标按钮
                function renderIpaButtons(type) {
                    const container = document.getElementById('ipa-container');
                    container.innerHTML = ''; // 清空现有内容

                    data[type].symbols.forEach(item => {
                        const button = document.createElement('div');
                        button.classList.add('ipa-btn');
                        button.textContent = item.symbol;
                        button.onclick = () => {
                            playSound(item.audio);
                            showDiagram(item.diagram);
                        };
                        container.appendChild(button);
                    });
                }
                // ——————————————————————————————————————————————————————————————————————————
                // 显示图解
                function showDiagram(imagePath) {
                    const diagramContainer = document.getElementById('diagram-container');
                    diagramContainer.innerHTML = ''; // 清空图解容器

                    const img = document.createElement('img');
                    img.src = imagePath;
                    img.alt = "音标图解";

                    diagramContainer.appendChild(img);
                }

                // ————————————————————————————————————————————————————————————————————————————
                // 播放音标发音
                function playSound(file) {
                    let audio = new Audio(file);
                    audio.play();
                }

                // 切换选项卡
                function showTab(tabName) {
                    // 隐藏所有选项卡内容
                    let tabBtns = document.querySelectorAll('.tab-btn');
                    tabBtns.forEach(btn => {
                        btn.classList.remove('active');
                    });

                    // 激活当前选项卡按钮
                    let activeBtn = document.getElementById(tabName + '-tab');
                    activeBtn.classList.add('active');

                    // 渲染对应的音标按钮
                    renderIpaButtons(tabName);
                }



                // 初始化页面
                generateTabs();
            } catch (error) {
                console.error('000', error);
            }
        }

        getJsonData();
    </script>
</body>

</html>
